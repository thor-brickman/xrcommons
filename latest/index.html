<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v6.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <title>TCXR</title>

    <link rel="stylesheet" href="css/main.css" />
    <link rel="icon" href="images/favicon.png" />

    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <script src="js/preload.js"></script>

    <!-- Scripts should ONLY be in here during debug when quick client iteration is required. -->
    <script>

    </script>

    <style>

    </style>

  </head>

  <body>

    <div id="splashScreen">
      <div id="splashText">
        Please click/touch the screen to begin.
      </div>
    </div>

    <div id="plotlydiv"></div>
    <img id="plotlyimage" width="512" height="512"></img>

    <video id="cameraFeed" width="640" height="480" webkit-playsinline playsinline style="display: none"></video>
    
    <a-scene id="mainScene" background="color: black">

      
      <a-assets>
        <img id="starfield" src="images/starfield.jpg">
        <img id="earth" src="images/earth.jpg">
        <img id="pictureorb" src="images/pictureorb.jpg">
        <img id="blankwhite" src="images/blankwhite.png" width="512" height="512">

        <audio id="welcome" preload="auto">
          <source src="audio/welcome.ogg" type="audio/ogg">
          <source src="audio/welcome.mp3" type="audio/mpeg">
        </audio>
        <audio id="crescendo" preload="auto">
          <source src="audio/crescendo.ogg" type="audio/ogg">
          <source src="audio/crescendo.mp3" type="audio/mpeg">
        </audio>
        <audio id="silenceAudio" preload="auto">
          <source src="audio/silence.ogg" type="audio/ogg">
          <source src="audio/silence.mp3" type="audio/mpeg">
        </audio>
      </a-assets>

      <a-sky id="skySphere"
        src="#starfield">
      </a-sky>

      <a-entity id="ambientlight" light="type: ambient; color: #FFFFFF; intensity: 1"></a-entity>

      <a-entity id="openingScenePivot" recenter="target: #introEarth">

        <a-entity id="directionallight"
          light="type: directional;
            color: #FFFFFF;
            intensity: 0.5;
            castShadow: true;
            shadowCameraBottom: -26;
            shadowCameraTop: -4;
            shadowCameraLeft: -20;
            shadowCameraRight: 14;
            shadowMapHeight: 1024;
            shadowMapWidth: 2014;"
          position= "-10 20 10">
        </a-entity>

        <a-sphere id="introEarth"
            data-clickable = "true"
            rotation = "0 0 0"
            animation__turning="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 30000;"
            animation__shrink="property: radius; startEvents: startshrink; to: 0.0001; dur: 1500; easing: linear;"
            cursor-listener
            material="src: #earth; color: #AAAAAA; roughness: 0.7; metalness: 0.8; emissive: #FFF; emissiveIntensity: 0.0;"
            position="0 0 -5"
            radius="1.25"
            color="#F7F4E9">
            <a-sphere id="picturesphere"
                position="0 0 0"
                rotation="0 0 0"
                radius="0.01"
                side="double"
                material="src: #pictureorb;"
                animation__rotation="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 5000;"
                animation__expand="property: radius; startEvents: startexpand; to: 10; dur: 4000; easing: easeInOutQuad;"
                animation__shrink="property: position; startEvents: startshrink; to: 10000 0 0; dur: 1500; easing: linear;">
            </a-sphere>
        </a-sphere>

      </a-entity data-description="Closure for openingScenePivot">

      <a-entity id="portalRoom"
        visible="false">

        <a-entity id="floor"
          geometry="primitive: circle"
          rotation="-90 0 0"
          position="0.0 -2 0.0"
          material="color: #FFF;"
          scale="13 13 1"
          shadow="receive: true">
        </a-entity>

        <a-entity id="DoorOne"
          gltf-model="models/DoorTest2.gltf"
          shadow="cast: true"
          scale="0.25 0.25 0.25"
          rotation="0 135.0 0"
          position="-7.586 -2.107 -2.157">
        </a-entity>
        <a-entity text="value: ENGAGEMENT; align: center;" position="-7.109 2.378 -1.707" scale="8 8 1" rotation="0 45 0"></a-entity>

        <a-entity id="DoorTwo"
          gltf-model="models/DoorTest2.gltf"
          shadow="cast: true"
          scale="0.25 0.25 0.25"
          rotation="0 90 0"
          position="0 -2.107 -6">
          <a-entity text="value: Persistence;"></a-entity>
        </a-entity>
        <a-entity id="WorldSphereTwo"
          geometry="primitive: sphere;
            thetaLength: 90;"
          position="0 0 -6.264"
          rotation="90 180 0"
          scale="5 5 5"
          material="color: #888;
            src: images/room1360.jpg;
            side: back;
            repeat: 1 0.5;
            offset: 0 -0.75;">
        </a-entity>
        <a-entity id="PortalMaskTwo"
          geometry="primitive: ring;"
          position="0 0 -2.959"
          rotation="0 0 0"
          scale="3.297 3.297 1"
          material="
            color: #FFF;">
        </a-entity>


        <a-entity id="DoorThree"
          gltf-model="models/DoorTest2.gltf"
          shadow="cast: true"
          scale="0.25 0.25 0.25"
          rotation="0 45 0"
          position="7.586 -2.107 -2.157">
          <a-entity text="value: Retention;"></a-entity>
        </a-entity>

        <a-entity id="DirectionalLight"
          light="castShadow: true;
            type: directional;
            shadowCameraBottom: -9;
            shadowCameraLeft: -10;
            shadowCameraRight: 11;
            shadowCameraTop: 10;
            shadowMapHeight: 1024;
            shadowMapWidth: 1024;"
          position="0 12 12"
          intensity="0.5">
        </a-entity>

      </a-entity data-description="Closure for portalRoom">

      <a-entity id="camerarig" position="0 0 0" rotation="0 0 0" wasd-controls>

          <a-entity
            id="camera"
            camera="active: true"
            look-controls position="0 0 0">

              <a-entity
                  id="mainCursor"
                  raycaster="far: 40; near: 0; objects: [data-clickable]"
                  cursor="fuse: true; fuseTimeout: 1000"
                  animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 100; from: 0.1 0.1 0.1; to: 1 1 1"
                  animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 500; from: 1 1 1; to: 0.1 0.1 0.1"
                  animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: white; shader: flat; transparent: true; opacity: 0.5;"
                  visible="false">
              </a-entity>

              <a-video
                id="arScreen"
                src="#cameraFeed"
                position="0 0 -1.0"
                width="3.0"
                height="1.688">
              </a-video>

              <a-text
                id="clickPrompt"
                visible="false"
                value="Please click to continue."
                position="-0.5 -0.5 -1.0"
                width="2"
                height="2"
                font="https://cdn.aframe.io/fonts/Exo2SemiBold.fnt"
                animation="property: color; easing: linear; loop: true; dur: 2000; from: #FFFFFF; to: #000000"
                color="white">
              </a-text>

          </a-entity>

      </a-entity>

    </a-scene>
    

    <!-- Scripts should ONLY be in here during debug when quick client iteration is required. -->
    <script>
    </script>

    <script src="js/main.js"></script>
  </body>
</html>