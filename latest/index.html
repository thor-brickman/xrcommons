<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v6.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="js/starfield.js"></script>

    <title>TCXR</title>

    <link rel="stylesheet" href="css/main.css" />
    <link rel="icon" href="images/favicon.png" />

    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <script src="js/preload.js"></script>

    <!-- Scripts should ONLY be in here during debug when quick client iteration is required. -->
    <script>
    </script>

    <style>
    </style>

  </head>

  <body>

    <div id="splashScreen">
      <div id="splashText">
        Please click/touch the screen to begin.
      </div>
    </div>

    <div id="plotlydiv"></div>
    <img id="plotlyimage" width="512" height="512"></img>

    <video id="cameraFeed" width="640" height="480" webkit-playsinline playsinline style="display: none"></video>
    
    <a-scene id="mainScene"
      fog
      background="color: black"
      renderer="antialias: true;
        alpha: false;">

      
      <a-assets>
        <img id="earth" src="images/earth.jpg">
        <img id="pictureorb" src="images/pictureorb.jpg">
        <img id="blankwhite" src="images/blankwhite.png" width="512" height="512">
        <img id="colorgrid" src="images/color-grid.png">
        <img id="portalonepicture" src="images/portalone360.jpg">
        <img id="portaltwopicture" src="images/portaltwo360.jpg">
        <img id="portalthreepicture" src="images/portalthree360.jpg">

        <audio id="welcome" preload="auto">
          <source src="audio/welcome.ogg" type="audio/ogg">
          <source src="audio/welcome.mp3" type="audio/mpeg">
        </audio>
        <audio id="crescendo" preload="auto">
          <source src="audio/crescendo.ogg" type="audio/ogg">
          <source src="audio/crescendo.mp3" type="audio/mpeg">
        </audio>
        <audio id="silenceAudio" preload="auto">
          <source src="audio/silence.ogg" type="audio/ogg">
          <source src="audio/silence.mp3" type="audio/mpeg">
        </audio>
      </a-assets>

      <a-sky color="black"></a-sky>
      <a-entity star-system></a-entity>

      <a-entity id="ambientlight" light="type: ambient; color: #FFFFFF; intensity: 1"></a-entity>

      <a-entity id="openingScenePivot" recenter="target: #introEarth">

        <a-entity id="directionallight"
          light="type: directional;
            color: #FFFFFF;
            intensity: 0.5;
            castShadow: true;
            shadowCameraBottom: -26;
            shadowCameraTop: -4;
            shadowCameraLeft: -20;
            shadowCameraRight: 14;
            shadowMapHeight: 1024;
            shadowMapWidth: 2014;"
          position= "-10 20 10">
        </a-entity>

        <a-sphere id="introEarth"
            data-clickable = "true"
            rotation = "0 0 0"
            animation__turning="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 30000;"
            animation__shrink="property: radius; startEvents: startshrink; to: 0.0001; dur: 1500; easing: linear;"
            cursor-listener
            material="src: #earth; color: #AAAAAA; roughness: 0.7; metalness: 0.8; emissive: #FFF; emissiveIntensity: 0.0;"
            position="0 0 -5"
            radius="1.25"
            color="#F7F4E9">
            <a-sphere id="picturesphere"
                position="0 0 0"
                rotation="0 0 0"
                radius="0.01"
                side="double"
                material="src: #pictureorb;"
                animation__rotation="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 5000;"
                animation__expand="property: radius; startEvents: startexpand; to: 10; dur: 4000; easing: easeInOutQuad;"
                animation__shrink="property: position; startEvents: startshrink; to: 10000 0 0; dur: 1500; easing: easeInOutQuad;">
            </a-sphere>
        </a-sphere>

      </a-entity data-description="Closure for openingScenePivot">

      <a-entity id="portalRoom"
        visible="false">

        <a-sphere id="portalsphere"
          radius="20"
          position="0 0 0"
          rotation="0 -90 0"
          material="src: images/forest.jpg;
            side: double;">
        </a-sphere>

        <a-sphere id="portalOne"
          radius="2.99"
          position="-6 0 -6"
          rotation="0 180 0"
          phi-length="180"
          material="color: #ffffff;
            side: back;
            transparent: true;
            src: #portalonepicture;
            repeat: 0.5 1;
            offset: 0.25 1;">
          <a-sphere id="portalOneOuterSphere"
          visible="true"
            radius="3"
            position="0 0 0"
            rotation="0 0 0"
            phi-length="180"
            material="color: #fc9803;
              side: front;
              src: #colorgrid;"
            cloak
            light="type: point;
                intensity: 0.25;
                color: #fc9803;">
          </a-sphere>
          <!-- <a-entity id="portalOneLight"
            position="0 -3 -4.5"
            rotation="160 3 0"
              light="type: spot;
                intensity: 1.3;
                color: #ffffff;
                angle: 27.2">
          </a-entity> -->
          <a-ring id="portalOneRing"
            visible="true"
            radius-outer="3.1"
            radius-inner="1.5"
            position="0 0 0"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            material="color: #ff9500;
              side: front;
              src: #colorgrid;"
            cloak>
          </a-ring>
          <a-ring id="portalOneGlowingRing"
            visible="true"
            radius-outer="2"
            radius-inner="1.5"
            position="0 0 0.1"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            material="color: #ff9500;
              side: front;
              repeat: 1 1;
              offset: 0 0;">
          </a-ring>
          <a-text id="portalOneText"
            value="Engagement"
            color="#ffffff"
            position="0 1.8 0"
            rotation="0 180 0"
            scale="1.5 1.5 1"
            align="center">
          </a-text>
        </a-sphere>

        <a-sphere id="portalTwo"
          radius="2.99"
          position="0 0 -6"
          rotation="0 180 0"
          phi-Length="180"
          material="color: #ffffff;
            side: back;
            transparent: true;
            src: #portaltwopicture;
            repeat: 0.5 1;
            offset: 0.25 1;">
          <a-sphere id="portalTwoOuterSphere"
            visible="true"
            radius="3"
            position="0 0 0"
            rotation="0 0 0"
            phi-Length="180"
            material="color: #2df026;
              side: front;
              src: #colorgrid;"
              cloak
              light="type: point;
                intensity: 0.25;
                color: #2df026;">
          </a-sphere>
          <!-- <a-entity id="portalTwoLight"
            position="0 -3 -4.5"
            rotation="160 0 0"
              light="type: spot;
                intensity: 1.3;
                color: #ffffff;
                angle: 27.2">
          </a-entity> -->
          <a-ring id="portalTwoRing"
            visible="true"
            radius-outer="3.1"
            radius-inner="1.5"
            position="0 0 0"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            cloak
            material="color: #2df026;
              side: front;
              src: #colorgrid;
              repeat: 1 1;
              offset: 0 0;">
          </a-ring>
          <a-ring id="portalTwoGlowingRing"
            visible="true"
            radius-outer="2"
            radius-inner="1.5"
            position="0 0 0.1"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            material="color: #2df026;
              side: front;
              repeat: 1 1;
              offset: 0 0;">
          </a-ring>
          <a-text id="portalTwoText"
            value="Persistence"
            color="#ffffff"
            position="0 1.8 0"
            rotation="0 180 0"
            align="center">
          </a-text>
        </a-sphere>

        <a-sphere id="portalThree"
          radius="2.99"
          position="6 0 -6"
          rotation="0 180 0"
          phi-length="180"
          material="color: #ffffff;
            side: back;
            transparent: true;
            src: #portalthreepicture;
            repeat: 0.5 1;
            offset: 0.25 0;">
          <a-sphere id="portalThreeOuterSphere"
            visible="true"
            radius="3"
            position="0 0 0"
            rotation="0 0 0"
            phi-length="180"
            material="color: #309bff;
              side: front;
              src: #colorgrid;"
            cloak
            light="type: point;
                intensity: 0.25;
                color: #309bff;">
          </a-sphere>
          <!-- <a-entity id="portalThreeLight"
            position="0 -3 -4.5"
            rotation="160 -3 0"
              light="type: spot;
                intensity: 1.3;
                color: #ffffff;
                angle: 27.2">
          </a-entity> -->
          <a-ring id="portalThreeRing"
            visible="true"
            radius-outer="3.1"
            radius-inner="1.5"
            position="0 0 0"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            material="color: #309bff;
              side: front;
              src: #colorgrid;"
            cloak>
          </a-ring>
          <a-ring id="portalThreeGlowingRing"
            visible="true"
            radius-outer="2"
            radius-inner="1.5"
            position="0 0 0.1"
            rotation="0 180 0"
            scale="1 1 1"
            segments-theta="64"
            material="color: #309bff;
              side: front;
              repeat: 1 1;
              offset: 0 0;">
          </a-ring>
          <a-text id="portalThreeText"
            value="Retention"
            color="#ffffff"
            position="0 1.8 0"
            rotation="0 180 0"
            align="center">
          </a-text>
        </a-sphere>

      </a-entity data-description="Closure for portalRoom">

      <a-entity id="camerarig" position="0 0 0" rotation="0 0 0" wasd-controls>

          <a-entity
            id="camera"
            camera="active: true"
            look-controls
            position="0 0 0">

              <a-entity
                  id="mainCursor"
                  raycaster="far: 40; near: 0; objects: [data-clickable]"
                  cursor="fuse: true; fuseTimeout: 1000"
                  animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 100; from: 0.1 0.1 0.1; to: 1 1 1"
                  animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 500; from: 1 1 1; to: 0.1 0.1 0.1"
                  animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: white; shader: flat; transparent: true; opacity: 0.5;"
                  visible="false">
              </a-entity>

              <a-video
                id="arScreen"
                src="#cameraFeed"
                position="0 0 -1.0"
                width="3.0"
                height="1.688">
              </a-video>

              <a-text
                id="clickPrompt"
                visible="false"
                value="Please click to continue."
                position="-0.5 -0.5 -1.0"
                width="2"
                height="2"
                font="https://cdn.aframe.io/fonts/Exo2SemiBold.fnt"
                animation="property: color; easing: linear; loop: true; dur: 2000; from: #FFFFFF; to: #000000"
                color="white">
              </a-text>

          </a-entity>

      </a-entity>

    </a-scene>
    

    <!-- Scripts should ONLY be in here during debug when quick client iteration is required. -->
    <script>
    </script>

    <script src="js/main.js"></script>
  </body>
</html>